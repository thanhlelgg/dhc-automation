"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const types_1=require("./types"),gondola_reporter_1=require("./gondola-reporter"),keeper_1=require("./keeper");class MochaReportHook{constructor(t,e){this.suiteID=0,this.testID=0,this.runner=t;e.reporterOptions;const s=new types_1.ReporterOptions;this.reporter=new gondola_reporter_1.GondolaReporter(s),keeper_1.setReporter(this.reporter),this.init()}init(){this.runner.on("start",this.start.bind(this)),this.runner.on("end",this.end.bind(this)),this.runner.on("suite",this.startSuite.bind(this)),this.runner.on("suite end",this.endSuite.bind(this)),this.runner.on("test",this.startTest.bind(this)),this.runner.on("test end",this.endTest.bind(this))}start(){this.reporter.start()}end(){this.reporter.done()}startSuite(t){if(t.root)return;t.gId=this.suiteID++;const e=cloneSuite(t);this.reporter.suiteStarted(e)}endSuite(t){if(t.root)return;const e=cloneSuite(t);this.reporter.suiteDone(e)}startTest(t){t.gId=this.testID++;const e=cloneSpec(t);this.reporter.specStarted(e)}endTest(t){const e=cloneSpec(t);this.reporter.specDone(e)}}const defaultSuite={failures:0,id:0,items:[],passes:0,skipped:0,specs:[],status:types_1.Status.Unkown,suites:[],title:"",type:types_1.TestTypes.Suite},defaultSpec={id:0,keywordSteps:[],messages:[],status:types_1.Status.Unkown,title:"",type:types_1.TestTypes.Spec};function cloneSuite(t){const e=Object.assign({},defaultSuite);return e.title=t.title,e.id=t.gId,e}function cloneSpec(t){const e=Object.assign({},defaultSpec);return"passed"===t.state?e.status=types_1.Status.Passed:"failed"===t.state?e.status=types_1.Status.Failed:"pending"!==t.state&&"disable"!==t.state||(e.status=types_1.Status.Pending),e.err=t.err,e.title=t.title,e.id=t.gId,e}module.exports=MochaReportHook;
//# sourceMappingURL=../../debug/reporter/mocha-report-hook.js.map
